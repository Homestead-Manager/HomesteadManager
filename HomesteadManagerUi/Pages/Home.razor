@page "/"
@inject NavigationManager _nav
@inject HttpClient Http
<style>
    .homestead-card {
        cursor: pointer;
        width: 18rem;
        margin-bottom: 10px;
    }
    .homestead-card:hover {
        background-color: gray;
    }
</style>
<PageTitle>Home</PageTitle>

<h1>Homesteads</h1>

@foreach (var hs in homesteads)
{
    <div class="homestead-card">
        <Card @onclick="@(()=>_nav.NavigateTo("/homesteads/" + @hs.Id))" class="homestead-card">
            <CardBody>
                <CardTitle>@hs.Name</CardTitle>
            </CardBody>
        </Card>
    </div>

}

<form @onsubmit="AddHomestead">
    <input placeholder="Homestead Name" @bind="newHomesteadName" />
    <button>Add Homestead</button>
</form>

@code {
    private string? newHomesteadName;
    private List<Homestead> homesteads = new();


    protected override async Task OnInitializedAsync() =>
        homesteads = await Http.GetFromJsonAsync<List<Homestead>>("api/Homestead") ?? [];
            
    private void AddHomestead()
    {
        if (!string.IsNullOrWhiteSpace(newHomesteadName))
        {
            var homestead = new Homestead { Id = Guid.NewGuid().ToString(), Name = newHomesteadName };
            homesteads.Add(homestead);
            Http.PostAsJsonAsync<Homestead>("api/Homestead", homestead);
        }
    }
}